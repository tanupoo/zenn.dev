---
title: "LoRaWAN: FUOTAのデモの解析"
emoji: ""
type: "tech"
topics: [LoRaWAN, Actility]
published: false
---

created: 2022-03-01

## デモ動画の解析

https://www.youtube.com/watch?v=WIbV85K9cIs

- EU868
- Class C
- ファームウエアのサイズ: 72560 B
- 72576 にパディングして、648個のフラグメントに分割。
    + フラグメントのサイズ: 112 B
- NSのダッシュボード上のFUOTAの時間
    + 開始: 11:10:40
    + 終了: 13:11:21
    + 7241秒(2時間41秒)
        * セットアップの時間が含まれているかは不明。
    + 単純計算すると約11秒に1回送信している。
        * `11.174 = 7241/648`
- MCセットアップ、フラグメントセットアップ
    + DR3 SF9で20固程度のDLがある。
    + 時間にすると約15秒。
        * ステート移動の待ち時間がないとする。
- マルチキャストのDL
    + DR3 SF9(Max 123B)
    + SF9で 123Bを伝送すると 0.677秒かかる。
    + **DC 1%では、67.7秒毎に伝送することになる。**
    + **実際は 11秒毎に送っている。**
        * DC 6% `6.059 = 0.677/11.174*100`
    + なぜ11秒毎に送っている理由は不明。
- DLの総伝送時間は、0.677秒*648個で438.696秒
- **DC 1%で再送なしの時の最小時間は約12時間**
    + `12.186 = 0.677*648*100/3600`

## 日本の場合

- 20mW, CW 200kHz
- 24CH-38CH 
    + CS: 5ms以上
    + TxD: 4s
    + 休止時間: 50ms
    + DC: なし
    + 理想環境では 7.9時間
        * `7.906 = (0.677 + 0.005 + 0.050) * 648`
- 36CH-61CH
    + CS: 128us以上
    + TxD: (200ms, 400ms]
    + 休止時間: min(TxD*10, 2ms)
    + DC: 360 s/h
    + 上記デモでは0.677秒かかるので、このルールは使えない。
    + 仮に400ms以内で送信が終わるとすれば、理想環境では 約47分
        * `47.521 = (0.4 + 0.000128 + 4) * 648 / 60`
